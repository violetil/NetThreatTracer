import requests
import json

def send_traffic_data(computer_id, traffic_data):
    url = f'http://localhost:5000/api/computers/{computer_id}/traffic'
    headers = {'Content-Type': 'application/json'}
    response = requests.post(url, data=json.dumps(traffic_data), headers=headers)
    if response.status_code == 200:
        print('Traffic data sent successfully:', response.json())
    else:
        print('Failed to send traffic data:', response.status_code, response.text)

# 示例流量数据
traffic_data = {
    'src_ip': '192.168.1.1',
    'dst_ip': '10.0.0.1',
    'src_port': 12345,
    'dst_port': 80,
    'protocol': 'TCP',
    'flow_duration': 120,
    'fwd_packets': 100,
    'bwd_packets': 80,
    'fwd_bytes': 1024,
    'bwd_bytes': 2048,
    'fwd_len_max': 100,
    'fwd_len_min': 10,
    'fwd_len_mean': 50,
    'fwd_len_std': 10,
    'bwd_len_max': 200,
    'bwd_len_min': 20,
    'bwd_len_mean': 100,
    'bwd_len_std': 20,
    'flow_bytes_per_s': 30,
    'flow_packets_per_s': 1,
    'fwd_packets_per_s': 0.5,
    'bwd_packets_per_s': 0.5,
    'iat_mean': 10,
    'iat_std': 2,
    'iat_max': 20,
    'iat_min': 1,
    'fwd_iat_total': 50,
    'fwd_iat_mean': 10,
    'fwd_iat_std': 1,
    'fwd_iat_max': 5,
    'fwd_iat_min': 0.5,
    'bwd_iat_total': 50,
    'bwd_iat_mean': 10,
    'bwd_iat_std': 1,
    'bwd_iat_max': 5,
    'bwd_iat_min': 0.5,
    'fwd_psh_flags': 1,
    'bwd_psh_flags': 1,
    'fwd_urg_flags': 0,
    'bwd_urg_flags': 0,
    'fwd_header_length': 20,
    'bwd_header_length': 20,
    'pkt_len_max': 1500,
    'pkt_len_min': 100,
    'pkt_len_mean': 500,
    'pkt_len_std': 100,
    'pkt_len_var': 10,
    'fin_flag_count': 1,
    'syn_flag_count': 1,
    'rst_flag_count': 0,
    'psh_flag_count': 1,
    'ack_flag_count': 1,
    'urg_flag_count': 0,
    'cwe_flag_count': 0,
    'ece_flag_count': 0,
    'down_up_ratio': 1,
    'avg_pkt_size': 500,
    'avg_fwd_seg_size': 250,
    'avg_bwd_seg_size': 250,
    'init_win_bytes_fwd': 8192,
    'init_win_bytes_bwd': 8192,
    'act_data_pkt_fwd': 10,
    'min_seg_size_fwd': 50,
    'active_mean': 100,
    'active_std': 10,
    'active_max': 120,
    'active_min': 80,
    'idle_mean': 50,
    'idle_std': 5,
    'idle_max': 60,
    'idle_min': 40,
    'fwd_avg_bytes_bulk': 0,
    'fwd_avg_packets_bulk': 0,
    'fwd_avg_bulk_rate': 0,
    'bwd_avg_bytes_bulk': 0,
    'bwd_avg_packets_bulk': 0,
    'bwd_avg_bulk_rate': 0,
    'subflow_fwd_packets': 50,
    'subflow_fwd_bytes': 2048,
    'subflow_bwd_packets': 50,
    'subflow_bwd_bytes': 4096,
    'prediction': 'DDoS'
}

# 发送流量数据到后端
send_traffic_data('6699202a1fdee5eb6185cb8d', traffic_data)
